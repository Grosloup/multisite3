{% extends "ZPBSitesZooBundle:Layouts:master.html.twig" %}
{% block title %}Mon panier | Parrainez un animal{% endblock %}
{% block headStyles %}
    {{ parent() }}
    <style>
        .pack{
            background-color: #abbabe;
            padding-top: 16px;
            padding-bottom: 16px;
            margin-bottom: 16px;
            -webkit-border-radius: 5px;
            -moz-border-radius: 5px;
            -ms-border-radius: 5px;
            -o-border-radius: 5px;
            border-radius: 5px;
        }
        .pack .thumbnail{
            margin-bottom: 0;
        }
    </style>
{% endblock %}

{% block content %}
    <div class="container">
        <div class="row">
            <div class="col-6">
                <div class="page-header">
                    <h1>Votre Panier</h1>
                </div>
            </div>
        </div>
        <div class="spaced-row">
            <div class="col-4">
                {{ render(controller("ZPBSitesZooBundle:Parrainage/Index:connect")) }}
            </div>
            <div class="col-2">
                {#{{ render(controller("ZPBSitesZooBundle:Parrainage/Index:getBasket")) }}#}
            </div>
        </div>
        <div class="spaced-row">
            <div class="col-6">
                {% if packs|length > 0 %}
                    <table style="width: 100%;" id="cart">

                        <thead>
                        <tr>
                            <th colspan="2">Animal</th>
                            <th>Formule</th>
                            <th>Bénéficiaire</th>
                            <th>Différé</th>
                            <th  class="text-right">Montant</th>
                        </tr>
                        </thead>
                        <tbody>



                        {% for id,pack in packs %}
                        <tr>
                            <td><img src="http://lorempicsum.com/nemo/80/60/1" alt="" width="100%"/></td>
                            <td class="bold">{{ pack.animal.name }}</td>

                            <td>{{ pack.pack.name }}</td>
                            <td>
                                {% if pack.godparent != null %}
                                {{ pack.godparent.firstname }} {{ pack.godparent.lastname }}
                                {% else %}Vous{% endif %}
                            </td>
                            <td>
                                {%  if pack.delayed != null %}Parrainage différé au {{ pack.delayed|date("d/m/y") }}{% else %} - {% endif %}
                            </td>
                            <td class="bold">
                                <table>
                                    <tr>
                                        <td class="text-right">{{ pack.pack.price }}&euro;</td>
                                    </tr>
                                    <tr>
                                        <td class="text-right"><a class="btn btn-grisfonce" href="{{ path("zpb_sites_zoo_parrainage_remove_from_basket", {id: id, _token: csrf_token("delete_from_basket")}) }}">Supprimer cet article</a></td>
                                    </tr>
                                </table>
                            </td>
                            {#<td><a class="btn btn-danger" href="{{ path("zpb_sites_zoo_parrainage_remove_from_basket", {id: id, _token: csrf_token("delete_from_basket")}) }}"><span class="label alert"><i class="fa fa-trash-o"></i></span></a></td>#}
                        </tr>
                        {% endfor %}

                        <tr>
                            {% set price = 0 %}
                            {% set priceRedux = 0 %}
                            {% for pack in packs %}
                                {% set price = price + pack.pack.price %}
                                {% set priceRedux = priceRedux + pack.pack.taxFreePrice %}
                            {% endfor %}
                            <td colspan="3">Montant total <strong>{{ price|number_format(2,',','.') }}&euro;</strong></td>
                            <td colspan="2">soit <strong>{{ priceRedux|number_format(2,',','.') }}&euro;</strong> après reduction fiscale</td>
                            <td></td>
                        </tr>
                        </tbody>
                    </table>

                {% else %}
                    <p>Votre panier est vide.</p>
                {% endif %}
            </div>
        </div>

        <div class="spaced-row">
            <div class="col-6">
                <a class="btn btn-primary btn-xlarge" href="{{ path("zpb_sites_zoo_parrainages_homepage") }}">Ajouter des parrainages</a>
                {% if packs|length > 0 %}
                    <a class="btn btn-primary btn-xlarge" href="{{ path("zpb_sites_zoo_parrainages_login_or_register", {type: "internet"}) }}">Regler par carte bancaire</a> {# TODO #}
                    <a class="btn btn-primary btn-xlarge" href="{{ path("zpb_sites_zoo_parrainages_login_or_register", {type: "postal"}) }}">Regler par courrier</a> {# TODO #}

                {% endif %}
            </div>
        </div>
    </div>
{% endblock %}

{% block footScripts %}
    {{ parent() }}
    <script src="/js/app.min.js"></script>
{% endblock %}
