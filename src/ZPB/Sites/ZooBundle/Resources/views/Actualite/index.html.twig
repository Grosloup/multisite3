{% extends "ZPBSitesZooBundle:Layouts:master.html.twig" %}
{% block title %}Actualités{% endblock %}

{% set active_page = "news" %}

{% block content %}
    <div class="container">
        <div class="row">
            <div class="col-md-6">
                <div class="page-header">
                    <h1>Actualité</h1>
                </div>
            </div>
        </div>
    </div>
    <div class="container">
        <div class="row">
            <div class="col-md-6">
                <div class="posts">
                    <div class="row">
                    {% for post in posts %}
                        <div class="post-col">
                            <div class="post">
                                <div class="post-category"><a href="{{ path("zpb_sites_zoo_actualites_list_by_category", {slug: post.category.slug}) }}">{{ post.category }}</a></div>
                                <h1 class="post-title"><a href="{{ path("zpb_sites_zoo_actualites_single", {slug: post.slug }) }}">{{ post.title }}</a></h1>
                                <div class="post-date">{{ post.publishedAt|date("d/m/y") }}</div>
                                {% if post.squarreThumb != null %}
                                    <div class="post-thumbnail">
                                        <img src="{{ post_img_url(post.squarreThumb) }}" alt=""/>
                                    </div>
                                {% endif %}

                                <div class="post-thumbnail">
                                    <img src="http://lorempicsum.com/rio/200/200/2" alt=""/>
                                </div>

                                <div class="post-excerpt">
                                    <p>{{ post.excerpt }}</p>
                                    <div class="post-more"><a href="{{ path("zpb_sites_zoo_actualites_single", {slug: post.slug }) }}">Lire plus...</a></div>
                                </div>

                                {% if post.tags|length > 0 %}
                                <div class="post-tags">
                                    <ul>
                                        {% for tag in post.tags %}
                                        <li><a href="{{ path("zpb_sites_zoo_actualites_list_by_tag", {slug: tag.slug}) }}">{{ tag.name }}</a>{% if loop.last != true %}, {% endif %}</li>
                                        {% endfor %}
                                    </ul>
                                </div>
                                {% endif %}
                            </div>
                        </div>


                    {% endfor %}

                    <div class="post-col">
                        <div class="post">
                            {#<div class="post-category"><a href="{{ path("zpb_sites_zoo_actualites_list_by_category", {slug: post.category.slug}) }}">{{ post.category }}</a></div>#}
                            <h1 class="post-title"><a href="#">Lorem ipsum dolor</a></h1>
                            <div class="post-date">10/1014</div>


                            <div class="post-thumbnail">
                                <img src="http://lorempicsum.com/rio/200/200/2" alt=""/>
                            </div>

                            <div class="post-excerpt">
                                <p>Lorem ipsum dolor sit amet, consectetur adipisicing elit. Consequuntur fuga fugit
                                    nisi, quidem rem sed voluptas. Consequatur sapiente similique voluptate?
                                    Accusamus dolores ex fugiat minus necessitatibus numquam qui, quod
                                    voluptate.</p>
                                <div class="post-more"><a href="#">Lire plus...</a></div>
                            </div>


                            <div class="post-tags">
                                <ul>
                                    <li><a href="#">lorem</a></li>
                                    <li><a href="#">lorem</a></li>
                                    <li><a href="#">lorem</a></li>
                                    <li><a href="#">lorem</a></li>
                                </ul>
                            </div>


                        </div>
                    </div>
                    <div class="post-col">
                        <div class="post">
                            {#<div class="post-category"><a href="{{ path("zpb_sites_zoo_actualites_list_by_category", {slug: post.category.slug}) }}">{{ post.category }}</a></div>#}
                            <h1 class="post-title"><a href="#">Lorem ipsum dolor</a></h1>
                            <div class="post-date">10/1014</div>


                            <div class="post-thumbnail">
                                <img src="http://lorempicsum.com/rio/200/200/2" alt=""/>
                            </div>

                            <div class="post-excerpt">
                                <p>Lorem ipsum dolor sit amet, consectetur adipisicing elit. Consequuntur fuga fugit
                                    nisi, quidem rem sed voluptas. Consequatur sapiente similique voluptate?
                                    Accusamus dolores ex fugiat minus necessitatibus numquam qui, quod
                                    voluptate.</p>
                                <div class="post-more"><a href="#">Lire plus...</a></div>
                            </div>


                            <div class="post-tags">
                                <ul>
                                    <li><a href="#">lorem</a></li>
                                    <li><a href="#">lorem</a></li>
                                    <li><a href="#">lorem</a></li>
                                    <li><a href="#">lorem</a></li>
                                </ul>
                            </div>


                        </div>
                    </div>
                        <div class="post-col">
                            <div class="post">
                                {#<div class="post-category"><a href="{{ path("zpb_sites_zoo_actualites_list_by_category", {slug: post.category.slug}) }}">{{ post.category }}</a></div>#}
                                <h1 class="post-title"><a href="#">Lorem ipsum dolor</a></h1>
                                <div class="post-date">10/1014</div>


                                <div class="post-thumbnail">
                                    <img src="http://lorempicsum.com/rio/200/200/2" alt=""/>
                                </div>

                                <div class="post-excerpt">
                                    <p>Lorem ipsum dolor sit amet, consectetur adipisicing elit. Consequuntur fuga fugit
                                        nisi, quidem rem sed voluptas. Consequatur sapiente similique voluptate?
                                        Accusamus dolores ex fugiat minus necessitatibus numquam qui, quod
                                        voluptate.</p>
                                    <div class="post-more"><a href="#">Lire plus...</a></div>
                                </div>


                                <div class="post-tags">
                                    <ul>
                                        <li><a href="#">lorem</a></li>
                                        <li><a href="#">lorem</a></li>
                                        <li><a href="#">lorem</a></li>
                                        <li><a href="#">lorem</a></li>
                                    </ul>
                                </div>


                            </div>
                        </div>
                        <div class="post-col">
                            <div class="post">
                                {#<div class="post-category"><a href="{{ path("zpb_sites_zoo_actualites_list_by_category", {slug: post.category.slug}) }}">{{ post.category }}</a></div>#}
                                <h1 class="post-title"><a href="#">Lorem ipsum dolor</a></h1>
                                <div class="post-date">10/1014</div>


                                <div class="post-thumbnail">
                                    <img src="http://lorempicsum.com/rio/200/200/2" alt=""/>
                                </div>

                                <div class="post-excerpt">
                                    <p>Lorem ipsum dolor sit amet, consectetur adipisicing elit. Consequuntur fuga fugit
                                        nisi, quidem rem sed voluptas. Consequatur sapiente similique voluptate?
                                        Accusamus dolores ex fugiat minus necessitatibus numquam qui, quod
                                        voluptate.</p>
                                    <div class="post-more"><a href="#">Lire plus...</a></div>
                                </div>


                                <div class="post-tags">
                                    <ul>
                                        <li><a href="#">lorem</a></li>
                                        <li><a href="#">lorem</a></li>
                                        <li><a href="#">lorem</a></li>
                                        <li><a href="#">lorem</a></li>
                                    </ul>
                                </div>


                            </div>
                        </div>
                        <div class="post-col">
                            <div class="post">
                                {#<div class="post-category"><a href="{{ path("zpb_sites_zoo_actualites_list_by_category", {slug: post.category.slug}) }}">{{ post.category }}</a></div>#}
                                <h1 class="post-title"><a href="#">Lorem ipsum dolor</a></h1>
                                <div class="post-date">10/1014</div>


                                <div class="post-thumbnail">
                                    <img src="http://lorempicsum.com/rio/200/200/2" alt=""/>
                                </div>

                                <div class="post-excerpt">
                                    <p>Lorem ipsum dolor sit amet, consectetur adipisicing elit. Consequuntur fuga fugit
                                        nisi, quidem rem sed voluptas. Consequatur sapiente similique voluptate?
                                        Accusamus dolores ex fugiat minus necessitatibus numquam qui, quod
                                        voluptate.</p>
                                    <div class="post-more"><a href="#">Lire plus...</a></div>
                                </div>


                                <div class="post-tags">
                                    <ul>
                                        <li><a href="#">lorem</a></li>
                                        <li><a href="#">lorem</a></li>
                                        <li><a href="#">lorem</a></li>
                                        <li><a href="#">lorem</a></li>
                                    </ul>
                                </div>


                            </div>
                        </div>
                    <div class="post-col">
                        <div class="post">
                            {#<div class="post-category"><a href="{{ path("zpb_sites_zoo_actualites_list_by_category", {slug: post.category.slug}) }}">{{ post.category }}</a></div>#}
                            <h1 class="post-title"><a href="#">Lorem ipsum dolor</a></h1>
                            <div class="post-date">10/1014</div>


                            <div class="post-thumbnail">
                                <img src="http://lorempicsum.com/rio/200/200/2" alt=""/>
                            </div>

                            <div class="post-excerpt">
                                <p>Lorem ipsum dolor sit amet, consectetur adipisicing elit. Consequuntur fuga fugit
                                    nisi, quidem rem sed voluptas. Consequatur sapiente similique voluptate?
                                    Accusamus dolores ex fugiat minus necessitatibus numquam qui, quod
                                    voluptate.</p>
                                <div class="post-more"><a href="#">Lire plus...</a></div>
                            </div>


                            <div class="post-tags">
                                <ul>
                                    <li><a href="#">lorem</a>,</li>
                                    <li><a href="#">lorem</a>,</li>
                                    <li><a href="#">lorem</a>,</li>
                                    <li><a href="#">lorem</a></li>
                                </ul>
                            </div>


                        </div>
                    </div>


                    </div>
                </div>
            </div>
            {#<div class="col-md-1">
                {{ render(controller("ZPBSitesZooBundle:Actualite:listCategories")) }}
                {{ render(controller("ZPBSitesZooBundle:Actualite:listTags")) }}
            </div>#}
        </div>

    </div>
{% endblock %}

{% block footScripts %}
    {{ parent() }}
    <script>
        (function($,w){
            function ExcerptShortener(el, options){
                this.options = $.extend({}, excerptShortenerDefaults, options || {});
                this.$el = $(el);
                this.chars = [];
                this.init();
            }

            ExcerptShortener.prototype.init = function(){
                this.originalText = this.$el.text();
                this.finalText = this.$el.text();
                if(this.originalText.length > this.options.maxLength){
                    this.reduce();
                }
            };

            ExcerptShortener.prototype.reduce = function(){
                this.finalText =
                        "<p>"
                        + this.originalText.substr(0, this.options.maxLength)
                        + "<span class='excerpt-more'>" + this.options.replacementText + "</span>"
                        +"</p>";
                this.$el.hide();
                this.$el.before(this.finalText);
            };

            var excerptShortenerDefaults = {
                maxLength: 200,
                replacementText: " ... "
            };

            $.fn.excerptShortener = function(options){

                return this.each(function(){

                    if(!$.data(this, "excerptShortener")){
                        $.data(this, "excerptShortener", new ExcerptShortener(this, options));
                    }
                });
            };

        })(jQuery, this);
    </script>
    <script>
        $(function(){

            var excerpts = $(".post-excerpt > p");
            excerpts.excerptShortener();

        });
    </script>
{% endblock %}
