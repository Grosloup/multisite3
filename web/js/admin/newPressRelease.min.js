!function(a){function b(b,c,d,e){function f(b){var d=a.parseJSON(b.target.responseText);d.error?(i.text(d.msg),k.width("0%"),c.data("droppable",!0)):(j.hide(),i.text(d.msg),k.width("0%"),k.parent().hide(),c.data("droppable",!1),e.targetId&&a(e.targetId).val(d.pdfFilename))}function g(a){if(a.lengthComputable){var b=Math.round(a.loaded/a.total*100)+"%";k.width(b)}}var h=b[d],i=c.find(e.message);if(!1 in h)return i.text("L'élément déposé n'est pas un fichier"),!1;if(h.size>e.maxSize)return i.text("L'élément déposé est trop lourd"),!1;if(e.allow.indexOf(h.type)<0)return i.text("L'élément déposé n'est pas du bon type"),!1;var j=c.find(e.droparea),k=c.find(e.progressbar),l=(c.find(e.actions),new XMLHttpRequest);l.addEventListener("load",f,!1),l.upload.addEventListener("progress",g,!1),l.open("post",e.url,!0),l.setRequestHeader("X-Requested-With","XMLHttpRequest"),l.setRequestHeader("Content-Type","multipart/form-data"),l.setRequestHeader("X-File-Name",h.name),l.setRequestHeader("X-File-Type",h.type),l.setRequestHeader("X-File-Size",h.size),l.setRequestHeader("X-File-Lang",e.lang),e.institution&&l.setRequestHeader("X-File-Institution",e.institution),l.send(h)}jQuery.event.props.push("dataTransfer");var c={multiple:!1,droparea:".dropzone-in",droploader:".dropzone-loader",progressbar:".dropzone-innerbar",actions:".dropzone-actions",message:".dropzone-message",deleteBtn:".dropzone-delete-btn",hover:"hover",legend:"Déposez votre pdf ici",allow:["application/pdf"],maxSize:45e5,url:"",deleteImgUrl:"",institution:"",targetId:null,lang:"fr"};a.fn.uploadPdf=function(d){var e=a.extend({},c,d||{});return this.setInstitution=function(a){e.institution=a},this.each(function(){{var c=a(this),d=c.find(".dropzone-legend"),f=(c.find(e.progressbar),c.find(e.message));c.find(e.droparea)}d.text(e.legend),c.data("droppable",!0),c.on({dragenter:function(a){a.preventDefault()},dragover:function(b){b.preventDefault(),a(this).addClass(e.hover)},dragleave:function(b){b.preventDefault(),a(this).removeClass(e.hover)},drop:function(d){d.preventDefault(),null!=e.institution?(f.text(""),a(this).removeClass(e.hover),c.data("droppable")&&b(d.dataTransfer.files,c,0,e)):(a(this).removeClass(e.hover),f.text("Choisissez une institution !"))}})})}}(jQuery,this,document),$(function(){var a=$("#dropzone-pdf-fr"),b=$("#dropzone-pdf-en"),c={url:pdfUploadUrl,institution:null,targetId:"#press_release_form_pdfFr"},d={url:pdfUploadUrl,institution:null,targetId:"#press_release_form_pdfEn",lang:"en"},e=a.uploadPdf(c);console.log(e);var f=b.uploadPdf(d);$("#press_release_form_institution").on("change",function(a){a.preventDefault();var b=$(this).find("option:selected").val();null!=b&&(e.setInstitution(b),f.setInstitution(b))})});