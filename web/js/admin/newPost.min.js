!function(a){function b(b,c,d,e){function f(b){var d=a.parseJSON(b.target.responseText);d.error?i.text(d.msg):(j.after(d.html),j.hide(),i.text(d.msg),k.width("0%"),k.parent().hide(),l.removeClass("hide").addClass("show"),c.data("droppable",!1))}function g(a){if(a.lengthComputable){var b=Math.round(a.loaded/a.total*100)+"%";k.width(b)}}var h=b[d],i=c.find(e.message);if(!1 in h)return i.text("L'élément déposé n'est pas un fichier"),!1;if(h.size>e.maxSize)return i.text("L'élément déposé est trop lourd"),!1;if(e.allow.indexOf(h.type)<0)return i.text("L'élément déposé n'est pas du bon type"),!1;var j=c.find(e.droparea),k=c.find(e.progressbar),l=c.find(e.actions),m=new XMLHttpRequest;m.addEventListener("load",f,!1),m.upload.addEventListener("progress",g,!1),m.open("post",e.url,!0),m.setRequestHeader("X-Requested-With","XMLHttpRequest"),m.setRequestHeader("Content-Type","multipart/form-data"),m.setRequestHeader("X-File-Name",h.name),m.setRequestHeader("X-File-Type",h.type),m.setRequestHeader("X-File-Size",h.size),m.setRequestHeader("X-File-UploadDir",e.uploadDir),m.setRequestHeader("X-File-Id",c.data("longid")),m.send(h)}jQuery.event.props.push("dataTransfer");var c={multiple:!1,droparea:".dropzone-in",droploader:".dropzone-loader",progressbar:".dropzone-innerbar",actions:".dropzone-actions",message:".dropzone-message",deleteBtn:".dropzone-delete-btn",hover:"hover",legend:"Déposez votre image ici",allow:["image/jpeg","image/gif","image/png"],maxSize:45e5,url:"/xhr/upload/img",deleteImgUrl:"/xhr/supprimer/img",uploadDir:"imgs"};a.fn.uploadFile=function(d){var e=a.extend({},c,d||{});this.each(function(){var c=a(this),d=c.find(".dropzone-legend"),f=c.find(e.deleteBtn),g=c.find(e.progressbar),h=c.find(e.message),i=c.find(e.actions),j=c.find(e.droparea);d.text(e.legend),c.data("droppable",!0),c.on({dragenter:function(a){a.preventDefault()},dragover:function(b){b.preventDefault(),a(this).addClass(e.hover)},dragleave:function(b){b.preventDefault(),a(this).removeClass(e.hover)},drop:function(d){d.preventDefault(),a(this).removeClass(e.hover),c.data("droppable")&&b(d.dataTransfer.files,c,0,e)}}),f.on("click",function(b){b.preventDefault();var d=c.find("img"),f=d.data("id");c.data("droppable",!0),f&&a.get(e.deleteImgUrl+"/"+f).done(function(a){a.error?h.text("Une erreur est survenue !"):(d.remove(),g.parent().show(),h.text(""),i.removeClass("show").addClass("hide"),j.show())}).fail(function(){h.text("Une erreur est survenue !")})})})}}(jQuery,this,document),$(function(){function a(a){var b="<div class='form-row' id='post_form_tags_"+a+"_name_parent'><div class='form-field'><div class='row'><div class='column-10'><input type='text' id='post_form_tags_"+a+"_name' name='post_form[tags]["+a+"][name]'/></div><div class='column-2'><button class='removeTagBtn btn btn-primary' data-target='post_form_tags_"+a+"_name_parent'><i class='fa fa-minus'></i></button></div></div></div></div>";return $(b)}$("textarea[data-editor]").each(function(){var a=$(this),b=a.data("editor")||"html",c=a.data("editorsize")||"medium",d="small"==c?250:"medium"==c?400:"large"==c?600:800,e={position:"absolute",width:a.width(),height:d,"class":a.attr("class")},f=$("<div/>",e);f.insertBefore(a),a.css("display","none");var g=ace.edit(f[0]);g.getSession().setValue(a.val()),g.setTheme("ace/theme/merbivore"),g.getSession().setMode("ace/mode/"+b),g.getSession().setUseWrapMode(!0),g.getSession().setWrapLimitRange(80,80),g.renderer.setPrintMarginColumn(80),g.setOption("enableEmmet",!0),g.getSession().on("change",function(){a.val(g.getSession().getValue())})});var b,c,d;b=$("#addTagBtn"),c=$("#tagsContainer"),d=c.children().length,b.on("click",function(b){return b.preventDefault(),c.append(a(d++)),!1}),$("body").on("click",".removeTagBtn",function(a){a.preventDefault();var b=$("#"+$(this).data("target"))||null;b&&b.remove()});var e;e=$("#dropzone"),e.uploadFile()});