!function(a,b,c){jQuery.event.props.push("dataTransfer"),a.fn.animalImageUploader=function(b){function d(b,d,e,f){function g(b){var e=a.parseJSON(b.target.responseText);j.text(e.msg),l.width("0%"),d.data("droppable",!0),e.error||(k=a(c.createElement(f.element)),k.html(e.html),m.append(k))}function h(a){if(a.lengthComputable){var b=Math.round(a.loaded/a.total*100)+"%";l.width(b)}}var i=b[e],j=d.find(f.message);if(!1 in i)return j.text("L'élément déposé n'est pas un fichier"),!1;if(i.size>f.maxSize)return j.text("L'élément déposé est trop lourd"),!1;if(f.allow.indexOf(i.type)<0)return j.text("L'élément déposé n'est pas du bon type"),!1;var k,l=(d.find(f.droparea),d.find(f.progressbar)),m=a(f.target),n=new XMLHttpRequest;n.addEventListener("load",g,!1),n.upload.addEventListener("progress",h,!1),n.open("post",f.url,!0),n.setRequestHeader("X-Requested-With","XMLHttpRequest"),n.setRequestHeader("Content-Type","multipart/form-data"),n.setRequestHeader("X-File-Name",i.name),n.setRequestHeader("X-File-Type",i.type),n.setRequestHeader("X-File-Size",i.size),n.setRequestHeader("X-File-AnimalId",d.data("id")),n.send(i)}var e={url:"/uploads",type:"hd",target:null,element:null,droparea:".dropzone-in",droploader:".dropzone-loader",progressbar:".dropzone-innerbar",hover:"hover",legend:"Déposez votre image ici",allow:["image/jpeg"],maxSize:6e6,message:".dropzone-message"},f=a.extend({},e,b||{});this.each(function(){var b=a(this),c=b.find(".dropzone-legend");c.text(f.legend);b.find(f.progressbar),b.find(f.message),b.find(f.droparea);c.text(f.legend),b.data("droppable",!0),b.on({dragenter:function(a){a.preventDefault()},dragover:function(b){b.preventDefault(),a(this).addClass(f.hover)},dragleave:function(b){b.preventDefault(),a(this).removeClass(f.hover)},drop:function(c){c.preventDefault(),a(this).removeClass(f.hover),b.data("droppable")&&d(c.dataTransfer.files,b,0,f)}})})}}(jQuery,this,document),$(function(){var a=$("#hd-drop"),b=$("#wallpaper-drop"),c=$("#front-drop");a.animalImageUploader({url:"/parrainages/xhr/animal/ajouter/hd-images",type:"hd",target:"#hd-list",element:"li"}),b.animalImageUploader({url:"/parrainages/xhr/animal/ajouter/front-images",type:"wallpaper",target:"#wp-list",element:"li"}),c.animalImageUploader({url:"/parrainages/xhr/animal/ajouter/wallpaper-images",type:"front",target:"#front-list",element:"li"})});