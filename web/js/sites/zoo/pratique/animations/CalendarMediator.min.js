define(["require","exports","jquery","MonthSelector"],function(a,b,c,d){var e=function(){function a(b,d){this.evtManager=b,this.calendar=null,this.animations=null,this.shows=null,this.options={},this.options=c.extend(!0,{},a.DEFAULTS,d||{}),this.init()}return a.prototype.init=function(){this.attachEvents()},a.prototype.attachEvents=function(){this.evtManager.addEvent("c:state:ready",this.loadEvents,this),this.evtManager.addEvent("c:day:click",this.loadEvents,this)},a.prototype.loadEvents=function(a){var b=this.getCache(a.year,a.month,a.day),c=this;a.target.lock(),null!==b?(a.target.dispatchDatas(b),this.animations.dispatchDatas(b),this.shows.dispatchDatas(b)):this.httpGet(this.makeGetUrl(a)).done(function(b,d){b.error===!1?(a.target.dispatchDatas(b.datas),c.setCache(a.year,a.month,a.day,b.datas)):a.target.showError(b.message,d),console.log(a.target),a.target.unlock()}).fail(function(){a.target.showError(),a.target.unlock()})},a.prototype.makeGetUrl=function(a){var b=this.options.getUrl.replace("[[year]]",a.year).replace("[[month]]",a.month).replace("[[day]]",a.day);return this.options.baseUrl+b},a.prototype.set=function(a,b){1==this.hasOwnProperty(a)&&null==this[a]&&(this[a]=b)},a.prototype.getMonthSelector=function(){return new d.MonthSelector(this.calendar.curMonth,this.calendar.curYear,this.evtManager)},a.prototype.getLoader=function(){return{}},a.prototype.httpGet=function(a,b){return c.get(a,b||{})},a.prototype.setCache=function(b,c,d,e){var f=a;c+=1;var g=b+"",h=c+"",i=d+"";f.CACHE.hasOwnProperty(b+"")?f.CACHE[g].hasOwnProperty(h)?f.CACHE[g][h][i]=e:(f.CACHE[g][h]={},f.CACHE[g][h][i]=e):(f.CACHE[g]={},f.CACHE[g][h]={},f.CACHE[g][h][i]=e)},a.prototype.getCache=function(b,c,d){var e=a;c+=1;var f=b+"",g=c+"",h=d+"";return e.CACHE.hasOwnProperty(f)&&e.CACHE[f].hasOwnProperty(g)&&e.CACHE[f][g].hasOwnProperty(h)?e.CACHE[f][g][h]:null},a.DEFAULTS={baseUrl:"",getUrl:""},a.CACHE={},a}();b.CalendarMediator=e});